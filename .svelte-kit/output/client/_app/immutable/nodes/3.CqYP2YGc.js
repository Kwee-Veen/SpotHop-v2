import{s as Y,j as Ue,n as J,r as Ie,d as Q,e as oe,b as qe,f as Ce,o as Ne}from"../chunks/scheduler.DymJjos-.js";import{S as Z,i as x,e as m,c as g,a as v,d as h,b as u,f as k,g as d,E as ye,v as B,z as Oe,j as we,k as De,A as L,F as ze,s as I,l as C,G as W,u as ue,o as H,p as F,n as Ve,q as R,w as Be,m as He,t as j,h as A,r as X}from"../chunks/index.C8OdZkHj.js";import{C as Fe}from"../chunks/Card.BVWtR1hE.js";import{c as ce,l as Te,s as Re}from"../chunks/stores.kbMQnpkH.js";import{e as $e,S as je}from"../chunks/SpotList.Pz8vGJtb.js";import{s as ke}from"../chunks/spot-service.rzhWlNUk.js";import{L as Ae}from"../chunks/LeafletMap.C-X_9hrA.js";function Ee(l,a,e){const n=l.slice();return n[3]=a[e],n}function Se(l){let a,e=l[3]+"",n;return{c(){a=m("option"),n=we(e),this.h()},l(s){a=g(s,"OPTION",{});var o=v(a);n=De(o,e),o.forEach(h),this.h()},h(){a.__value=l[3],L(a,a.__value)},m(s,o){k(s,a,o),d(a,n)},p:J,d(s){s&&h(a)}}}function Xe(l){let a,e,n,s,o,t=$e(l[1]),i=[];for(let r=0;r<t.length;r+=1)i[r]=Se(Ee(l,t,r));return{c(){a=m("div"),e=m("div"),n=m("select");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){a=g(r,"DIV",{class:!0});var p=v(a);e=g(p,"DIV",{class:!0});var c=v(e);n=g(c,"SELECT",{});var y=v(n);for(let w=0;w<i.length;w+=1)i[w].l(y);y.forEach(h),c.forEach(h),p.forEach(h),this.h()},h(){l[0]===void 0&&Ue(()=>l[2].call(n)),u(e,"class","select"),u(a,"class","control")},m(r,p){k(r,a,p),d(a,e),d(e,n);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(n,null);ye(n,l[0],!0),s||(o=B(n,"change",l[2]),s=!0)},p(r,[p]){if(p&2){t=$e(r[1]);let c;for(c=0;c<t.length;c+=1){const y=Ee(r,t,c);i[c]?i[c].p(y,p):(i[c]=Se(y),i[c].c(),i[c].m(n,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=t.length}p&3&&ye(n,r[0])},i:J,o:J,d(r){r&&h(a),Oe(i,r),s=!1,o()}}}function Ge(l,a,e){const n=["Site","Locale","Activity","Scenery","Structure","Shopping","Uncategorised"];let{selectedCategory:s="Uncategorised"}=a;function o(){s=ze(this),e(0,s),e(1,n)}return l.$$set=t=>{"selectedCategory"in t&&e(0,s=t.selectedCategory)},[s,n,o]}class Je extends Z{constructor(a){super(),x(this,a,Ge,Xe,Y,{selectedCategory:0})}}function Ke(l){let a,e,n,s,o,t,i;return{c(){a=m("div"),e=m("input"),n=I(),s=m("div"),o=m("input"),this.h()},l(r){a=g(r,"DIV",{class:!0});var p=v(a);e=g(p,"INPUT",{class:!0,type:!0,min:!0,max:!0,step:!0,placeholder:!0,name:!0}),p.forEach(h),n=C(r),s=g(r,"DIV",{class:!0});var c=v(s);o=g(c,"INPUT",{class:!0,type:!0,min:!0,max:!0,step:!0,placeholder:!0,name:!0}),c.forEach(h),this.h()},h(){u(e,"class","input is-danger is-rounded"),u(e,"type","number"),u(e,"min","-90"),u(e,"max","90"),u(e,"step","0.00001"),u(e,"placeholder","Latitude"),u(e,"name","latitude"),e.required=!0,u(a,"class","field is-narrow"),u(o,"class","input is-danger is-rounded"),u(o,"type","number"),u(o,"min","-180"),u(o,"max","180"),u(o,"step","0.00001"),u(o,"placeholder","Longitude"),u(o,"name","longitude"),o.required=!0,u(s,"class","field is-narrow")},m(r,p){k(r,a,p),d(a,e),L(e,l[0]),k(r,n,p),k(r,s,p),d(s,o),L(o,l[1]),t||(i=[B(e,"input",l[2]),B(o,"input",l[3])],t=!0)},p(r,[p]){p&1&&W(e.value)!==r[0]&&L(e,r[0]),p&2&&W(o.value)!==r[1]&&L(o,r[1])},i:J,o:J,d(r){r&&(h(a),h(n),h(s)),t=!1,Ie(i)}}}function Qe(l,a,e){let{latitude:n=0}=a,{longitude:s=0}=a;function o(){n=W(this.value),e(0,n)}function t(){s=W(this.value),e(1,s)}return l.$$set=i=>{"latitude"in i&&e(0,n=i.latitude),"longitude"in i&&e(1,s=i.longitude)},[n,s,o,t]}class We extends Z{constructor(a){super(),x(this,a,Qe,Ke,Y,{latitude:0,longitude:1})}}function Ye(l){let a,e,n,s,o,t,i,r,p,c,y,w,f,$,V,b,T,S,ee,te,se,P,de='<button class="button is-danger is-rounded has-text-weight-bold is-size-5">Create Spot</button>',ae,ne,re,U,q,N,O,K,G,ie,fe;function Le(_){l[8](_)}let pe={};l[1]!==void 0&&(pe.selectedCategory=l[1]),r=new Je({props:pe}),Q.push(()=>ue(r,"selectedCategory",Le));function Me(_){l[9](_)}function Pe(_){l[10](_)}let le={};return l[2]!==void 0&&(le.latitude=l[2]),l[3]!==void 0&&(le.longitude=l[3]),f=new We({props:le}),Q.push(()=>ue(f,"latitude",Me)),Q.push(()=>ue(f,"longitude",Pe)),{c(){a=m("div"),e=m("form"),n=m("div"),s=m("div"),o=m("div"),t=m("input"),i=I(),H(r.$$.fragment),c=I(),y=m("div"),w=I(),H(f.$$.fragment),b=I(),T=m("div"),S=m("input"),ee=I(),te=m("br"),se=I(),P=m("div"),P.innerHTML=de,ae=I(),ne=m("br"),re=I(),U=m("div"),q=m("div"),N=m("div"),O=m("div"),K=we(l[5]),this.h()},l(_){a=g(_,"DIV",{class:!0});var D=v(a);e=g(D,"FORM",{});var E=v(e);n=g(E,"DIV",{class:!0});var z=v(n);s=g(z,"DIV",{class:!0});var M=v(s);o=g(M,"DIV",{class:!0});var he=v(o);t=g(he,"INPUT",{class:!0,placeholder:!0,type:!0,name:!0}),he.forEach(h),i=C(M),F(r.$$.fragment,M),c=C(M),y=g(M,"DIV",{class:!0}),v(y).forEach(h),w=C(M),F(f.$$.fragment,M),M.forEach(h),z.forEach(h),b=C(E),T=g(E,"DIV",{class:!0});var me=v(T);S=g(me,"INPUT",{class:!0,type:!0,placeholder:!0,name:!0}),me.forEach(h),ee=C(E),te=g(E,"BR",{}),se=C(E),P=g(E,"DIV",{class:!0,"data-svelte-h":!0}),Ve(P)!=="svelte-zikyt2"&&(P.innerHTML=de),ae=C(E),ne=g(E,"BR",{}),re=C(E),U=g(E,"DIV",{class:!0});var ge=v(U);q=g(ge,"DIV",{class:!0});var _e=v(q);N=g(_e,"DIV",{class:!0});var ve=v(N);O=g(ve,"DIV",{class:!0});var be=v(O);K=De(be,l[5]),be.forEach(h),ve.forEach(h),_e.forEach(h),ge.forEach(h),E.forEach(h),D.forEach(h),this.h()},h(){u(t,"class","input is-success"),u(t,"placeholder","Spot name"),u(t,"type","text"),u(t,"name","name"),t.required=!0,u(o,"class","field is-narrow"),u(y,"class","field is-narrow"),u(s,"class","field-body"),u(n,"class","field is-grouped-horizontal"),u(S,"class","input is-success"),u(S,"type","text"),u(S,"placeholder","Enter description"),u(S,"name","description"),u(T,"class","field"),u(P,"class","text has-text-centered"),u(O,"class","content has-text-centered is-italic"),u(N,"class","box has-background-warning-light"),u(q,"class","column is-narrow"),u(U,"class","columns is-mobile is-centered"),u(a,"class","box has-background-white")},m(_,D){k(_,a,D),d(a,e),d(e,n),d(n,s),d(s,o),d(o,t),L(t,l[0]),d(s,i),R(r,s,null),d(s,c),d(s,y),d(s,w),R(f,s,null),d(e,b),d(e,T),d(T,S),L(S,l[4]),d(e,ee),d(e,te),d(e,se),d(e,P),d(e,ae),d(e,ne),d(e,re),d(e,U),d(U,q),d(q,N),d(N,O),d(O,K),G=!0,ie||(fe=[B(t,"input",l[7]),B(S,"input",l[11]),B(e,"submit",Be(l[6]))],ie=!0)},p(_,[D]){D&1&&t.value!==_[0]&&L(t,_[0]);const E={};!p&&D&2&&(p=!0,E.selectedCategory=_[1],oe(()=>p=!1)),r.$set(E);const z={};!$&&D&4&&($=!0,z.latitude=_[2],oe(()=>$=!1)),!V&&D&8&&(V=!0,z.longitude=_[3],oe(()=>V=!1)),f.$set(z),D&16&&S.value!==_[4]&&L(S,_[4]),(!G||D&32)&&He(K,_[5])},i(_){G||(j(r.$$.fragment,_),j(f.$$.fragment,_),G=!0)},o(_){A(r.$$.fragment,_),A(f.$$.fragment,_),G=!1},d(_){_&&h(a),X(r),X(f),ie=!1,Ie(fe)}}}function Ze(l,a,e){let n;qe(l,ce,b=>e(12,n=b));let s="",o="Uncategorised",t=0,i=0,r="",p="Type in your new Spot's details above before hitting the red button";async function c(){if(s){let b={name:s,category:o,latitude:t,longitude:i,description:r,userid:n._id};if(await ke.createSpot(b,Ce(ce))){Te.set(b),e(5,p="Spot created! Scroll to the bottom of the page to see it");return}else{e(5,p="Spot not created - some error occurred");return}}else e(5,p="Please specify your new spot's details")}function y(){s=this.value,e(0,s)}function w(b){o=b,e(1,o)}function f(b){t=b,e(2,t)}function $(b){i=b,e(3,i)}function V(){r=this.value,e(4,r)}return[s,o,t,i,r,p,c,y,w,f,$,V]}class xe extends Z{constructor(a){super(),x(this,a,Ze,Ye,Y,{})}}function et(l){let a,e='<div class="column is-3"><box class="box has-background-white"><h2 class="h2 has-text-centered">Latest Spot</h2></box></div>',n,s,o;return s=new je({props:{spots:l[0]}}),{c(){a=m("div"),a.innerHTML=e,n=I(),H(s.$$.fragment),this.h()},l(t){a=g(t,"DIV",{class:!0,"data-svelte-h":!0}),Ve(a)!=="svelte-1vxgy4g"&&(a.innerHTML=e),n=C(t),F(s.$$.fragment,t),this.h()},h(){u(a,"class","columns is-mobile is-centered")},m(t,i){k(t,a,i),k(t,n,i),R(s,t,i),o=!0},p(t,i){const r={};i&1&&(r.spots=t[0]),s.$set(r)},i(t){o||(j(s.$$.fragment,t),o=!0)},o(t){A(s.$$.fragment,t),o=!1},d(t){t&&(h(a),h(n)),X(s,t)}}}function tt(l){let a,e,n,s,o,t,i,r,p,c,y;s=new xe({});let w={height:43,activeLayer:"Terrain"};return r=new Ae({props:w}),l[2](r),c=new Fe({props:{$$slots:{default:[et]},$$scope:{ctx:l}}}),{c(){a=m("div"),e=m("div"),n=m("box"),H(s.$$.fragment),o=I(),t=m("div"),i=m("box"),H(r.$$.fragment),p=I(),H(c.$$.fragment),this.h()},l(f){a=g(f,"DIV",{class:!0});var $=v(a);e=g($,"DIV",{class:!0});var V=v(e);n=g(V,"BOX",{class:!0});var b=v(n);F(s.$$.fragment,b),b.forEach(h),V.forEach(h),o=C($),t=g($,"DIV",{class:!0});var T=v(t);i=g(T,"BOX",{class:!0});var S=v(i);F(r.$$.fragment,S),S.forEach(h),T.forEach(h),$.forEach(h),p=C(f),F(c.$$.fragment,f),this.h()},h(){u(n,"class","box has-background-danger-light"),u(e,"class","column is-6"),u(i,"class","box"),u(t,"class","column is-6"),u(a,"class","columns is-mobile is-centered")},m(f,$){k(f,a,$),d(a,e),d(e,n),R(s,n,null),d(a,o),d(a,t),d(t,i),R(r,i,null),k(f,p,$),R(c,f,$),y=!0},p(f,[$]){const V={};r.$set(V);const b={};$&9&&(b.$$scope={dirty:$,ctx:f}),c.$set(b)},i(f){y||(j(s.$$.fragment,f),j(r.$$.fragment,f),j(c.$$.fragment,f),y=!0)},o(f){A(s.$$.fragment,f),A(r.$$.fragment,f),A(c.$$.fragment,f),y=!1},d(f){f&&(h(a),h(p)),X(s),l[2](null),X(r),X(c,f)}}}function st(l,a,e){let n=[],s;Re.set("Create a Spot"),Te.subscribe(async t=>{if(t){n.push(t),e(0,n=[...n]),s.moveTo(t.latitude,t.longitude);const i=`Spot "${t.name}" (${t.latitude} ${t.longitude}), category: ${t.category}`;s.addMarker(t.latitude,t.longitude,i),e(0,n=[]),n.push(t)}}),Ne(async()=>{e(0,n=await ke.getSpots(Ce(ce))),n.forEach(i=>{const r=`Spot "${i.name}" (${i.latitude} ${i.longitude}), category: ${i.category}`;s.addMarker(i.latitude,i.longitude,r)});const t=n[n.length-1];t&&s.moveTo(t.latitude,t.longitude),e(0,n=[]),n.push(t)});function o(t){Q[t?"unshift":"push"](()=>{s=t,e(1,s)})}return[n,s,o]}class ct extends Z{constructor(a){super(),x(this,a,st,tt,Y,{})}}export{ct as component};
